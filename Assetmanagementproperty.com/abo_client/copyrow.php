<?php
 session_start(); include_once("config.php"); $conn = null; if (!tryConnect()) { die(); } $name = @mysqli_real_escape_string($conn, $_GET["name"]); $primary = @mysqli_real_escape_string($conn, $_GET["primary"]); $primaryValue = @mysqli_real_escape_string($conn, $_GET["primaryValue"]); loadConfig(); loadAllCfg(); if (isset($_SESSION['user'])) { } else { if (@$cfgCustom["loginType"] != "No Password" && @$cfgCustom["loginType"] != "") { header("Location: login.php"); die(); } } $o = ""; $names = []; $types = []; $keys = array_keys($db[$name]); $k = 0; for($i=0; $i<count($keys); $i++) { if ($db[$name][$keys[$i]]["Status"] == 'Hidden') continue; $names[$k] = $keys[$i]; $types[$k] = $db[$name][$keys[$i]]["MySQL_Type"]; $k++; } $l = count($names); for($i=0; $i<$l-1; ++$i) { for($j=$i+1; $j < $l; ++$j) { if (intval($db[$name][$names[$i]]["Sort_Order"]) > intval($db[$name][$names[$j]]["Sort_Order"])) { $aux = $names[$i]; $names[$i] = $names[$j]; $names[$j] = $aux; $aux = $types[$i]; $types[$i] = $types[$j]; $types[$j] = $aux; } } } $sql = "SELECT * FROM $name WHERE $primary = '$primaryValue'"; $result = $conn->query($sql); $row = mysqli_fetch_array($result); for($i=0; $i<count($names);++$i) { if (@$cfgTables["multiuser_$name"] == $names[$i]) { continue; } $o .= "\"".str_replace("\"", "\"\"", $row[$names[$i]])."\""; if ($i < count($names)-1) { if (@$cfgDefault["chktabWhenCopy"]) $o .= "\t"; else $o .= ","; } } echo $o; ?>
